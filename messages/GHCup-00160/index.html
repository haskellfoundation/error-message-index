<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>JSON decoding failed [GHCup-00160] — Haskell Error Index</title>
  <link rel="stylesheet" href="../../css/highlight.css">
  <script src="../../js/highlight.min.js"></script>
  <link rel="stylesheet" href="../../css/default.css" />
  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="canonical" href="../../messages/GHCup-00160/" />
</head>

<body>
  <main role="main">
    <nav class="breadcrumb">
      
      <a href="../../">The Haskell Error Index</a>&nbsp;»
      
      JSON decoding failed [GHCup-00160]
    </nav>
    <h1>JSON decoding failed [GHCup-00160]</h1>
    

<p>This error is most common when GHCup tries to fetch the metadata file that contains information
about available tool versions and binary distributions. This is done when GHCup starts, so basically
any command such as <code>list</code>, <code>tui</code>, <code>install</code>, etc. can throw this.</p>
<p>Potential underlying causes for this errors are:</p>
<ul>
<li>No internet connection</li>
<li>Unreliable disk or Internet leading to a corrupted file</li>
<li>Non-functional <code>curl</code> or <code>wget</code> (users have reported difficulties when these tools are installed through <a href="https://snapcraft.io/">snap</a>)</li>
<li>Malformed metadata file, indicating an issue in the <a href="https://github.com/haskell/ghcup-metadata">ghcup-metadata</a> repository</li>
</ul>
<p>As an example with no internet connection, GHCup will fail to list available tools:</p>
<pre><code>$ ghcup list
[ Info  ] downloading: https://raw.githubusercontent.com/haskell/ghcup-metadata/master/ghcup-0.0.7.yaml as file /home/hasufell/.ghcup/cache/ghcup-0.0.7.yaml
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0curl: (6) Could not resolve host: raw.githubusercontent.com
[ Warn  ] Could not get download info, trying cached version (this may not be recent!)
[ ...   ] If this problem persists, consider switching downloader via:
[ ...   ]     ghcup config set downloader Wget
[ Error ] [GHCup-00160] JSON decoding failed with: YAML exception:
[ ...   ] Yaml file not found: /home/hasufell/.ghcup/cache/ghcup-0.0.7.yaml
[ ...   ] Consider removing /home/hasufell/.ghcup/cache/ghcup-0.0.7.yaml manually.
[ ...   ]</code></pre>
<p>If you use <code>ghcup --metadata-fetching-mode=Strict list</code>, then you’ll likely receive error
<a href="https://errors.haskell.org/messages/GHCup-05841/">GHCup-05841</a> instead.</p>
<p>The best way to debug this is to try to fetch the metadata manually:</p>
<pre><code>cd &quot;$(ghcup whereis cachedir)&quot;
curl https://raw.githubusercontent.com/haskell/ghcup-metadata/master/ghcup-0.0.7.yaml</code></pre>
<p>Alternatively try with wget:</p>
<pre><code>cd &quot;$(ghcup whereis cachedir)&quot;
wget -O- https://raw.githubusercontent.com/haskell/ghcup-metadata/master/ghcup-0.0.7.yaml</code></pre>
<p>If the download fails, your <code>curl</code>/<code>wget</code> installation might be broken. On Linux, make sure you’ve installed
these from your package manager and not via <a href="https://snapcraft.io/">snap</a>, <a href="https://flatpak.org/">Flatpak</a> or <a href="https://appimage.org/">AppImage</a>. GHCup neither recommends nor supports those tools.
On Windows, make sure you use <code>curl.exe</code> and not <code>curl</code> (which is a cmdlet) when testing. It should be pre-installed.</p>
<p>If the download succeeds, but the error persists, try examining the file and verify that it’s valid YAML:</p>
<pre><code>cat &quot;$(ghcup whereis cachedir)/ghcup-0.0.7.yaml&quot;</code></pre>
<p>Fix your connection issues, make sure to delete <code>$(ghcup whereis cachedir)/ghcup-0.0.7.yaml</code> and then try again.
If you believe this is not a connection issue and there’s something wrong with the file, please <a href="https://github.com/haskell/ghcup-metadata/issues">open an issue here</a>.</p>




  </main>

  <footer>
    <p class="HF foot">
      This site is a project of <a href="https://haskell.foundation" target="_blank" rel="noopener noreferrer">The
        Haskell Foundation</a>.
    </p>
    <p class="shoutout foot">
      Site proudly generated by
      <a href="http://jaspervdj.be/hakyll" target="_blank" rel="noopener noreferrer">Hakyll</a>
    </p>
  </footer>

  <script>document.querySelectorAll('code.language-haskell').forEach(el => {
      hljs.highlightElement(el);
    });</script>
</body>

</html>
