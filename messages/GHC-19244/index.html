<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Module is annotated as trustworthy, but is inferred as safe [GHC-19244] — Haskell Error Index</title>
  <link rel="stylesheet" href="../../css/highlight.css">
  <script src="../../js/highlight.min.js"></script>
  <link rel="stylesheet" href="../../css/default.css" />
  <link rel="stylesheet" href="../../css/theme.css" />
</head>

<body>
  <main role="main">
    <nav class="breadcrumb">
      
      <a href="../../">The Haskell Error Index</a>&nbsp;»
      
      Module is annotated as trustworthy, but is inferred as safe [GHC-19244]
    </nav>
    <h1>Module is annotated as trustworthy, but is inferred as safe [GHC-19244]</h1>
    
<p>
  <i>Flag: <code>-Wtrustworthy-safe</code></i><br />
  
      
      <i>Enabled by: <code>-Wall</code></i>
      
  
</p>


<p>GHC implements the <code>SafeHaskell</code> extension which allows programmers to restrict modules to a specific subset which is considered safe, and restricts access to “escape hatches” such as <code>unsafePerformIO</code>.
Details about Safe Haskell are available in <a href="https://downloads.haskell.org/ghc/latest/docs/users_guide/exts/safe_haskell.html">the GHC User’s Guide</a>.
There are two levels of safety: Safe modules are checked by GHC and are guaranteed to be safe, whereas trustworthy modules are checked by
the programmer who promises that the code cannot violate the guarantees of safe Haskell.
If GHC sees a module which is annotated as trustworthy, but inferred as safe, it emits a warning that the stricter “safe” annotation should be used instead.</p>



<h2>Examples</h2>

<details open="open">
  <summary>A module was annotated as trustworthy, but inferred as safe</summary>
  <div class="details-inner">
    <p>In this example the module was annotated as trustworthy, but GHC inferred that the module is also safe.
Since “safe” is a stronger guarantee than “trustworthy”, GHC warns that the module should be annotated as safe instead.
The warning can therefore be fixed by changing the annotation from trustworthy to safe.</p>
<pre><code>messages/GHC-19244/trustworthy-safe/before/TrustworthySafe.hs:1:27: warning: [GHC-19244] [-Wtrustworthy-safe]
    ‘TrustworthySafe’ is marked as Trustworthy but has been inferred as safe!
  |
1 | {-# LANGUAGE Haskell2010, Trustworthy #-}
  |</code></pre>

<pre class="filename">TrustworthySafe.hs</pre>
<div class="example-container">
  <div class="example">
    <div class="example-inner">
      <div class="example-title">Before</div>
      <!-- keep next line as is, i.e., on one line, or the code will not format properly -->
      <pre class="example-pre"><code class="language-haskell">{-# LANGUAGE Haskell2010, Trustworthy #-}
{-# OPTIONS_GHC -fwarn-trustworthy-safe #-}
module TrustworthySafe where

theAnswer :: Int
theAnswer = 42
</code></pre>
    </div>
  </div>
  <div class="example">
    <div class="example-inner">
      <div class="example-title">After</div>
      <!-- keep next line as is, i.e., on one line, or the code will not format propertly -->
      <pre class="example-pre"><code class="language-haskell">{-# LANGUAGE Haskell2010, Safe #-}
{-# OPTIONS_GHC -fwarn-trustworthy-safe #-}
module TrustworthySafe where

theAnswer :: Int
theAnswer = 42
</code></pre>
    </div>
  </div>
</div>


  </div>
</details>



  </main>

  <footer>
    <p class="HF foot">
      This site is a project of <a href="https://haskell.foundation" target="_blank" rel="noopener noreferrer">The
        Haskell Foundation</a>.
    </p>
    <p class="shoutout foot">
      Site proudly generated by
      <a href="http://jaspervdj.be/hakyll" target="_blank" rel="noopener noreferrer">Hakyll</a>
    </p>
  </footer>

  <script>document.querySelectorAll('code.language-haskell').forEach(el => {
      hljs.highlightElement(el);
    });</script>
</body>

</html>
